# movies-explorer-api
Бэкенд для дипломного проекта на курсах Веб-разработчик от Яндекс Практикума

Бэк отвечает за создание пользователя и его авторизацию, за добавление и удаление фильмов, а также за изменение информации о юзере.  


## Поддерживаемые типы запросов, не защищённые авторизацией:

POST http://api.badass.nomoredomains.club/signup - создание нового юзера. Необходимые параметры (x-www-form-urlencoded, например):
name: Строка, от 2 до 30 символов
email: валидный email-адрес, который можно проверить по шаблону
password: строка, от 8 символов    
  
POST http://api.badass.nomoredomains.club/signin - логин существующего пользователя. Необходимые параметры:
email и password, заданные при создании пользователя
В ответ приходит токен, необходимый для авторизации. Срок жизни токена - 7 дней.
  
## Типы запросов, защищённые авторизацией (Bearer Token) в Postman

GET http://api.badass.nomoredomains.club/users/me - информация о пользователе. Необходимые параметры - только токен.
  
PATCH http://api.badass.nomoredomains.club/users/me - изменение имени и почты пользователя. Необходимые параметры:
Токен, name и email
  
POST http://api.badass.nomoredomains.club/movies -  создание фильма. Необходимые параметры:
Токен
country: строка
director: строка
duration: число
year: число
description: строка
image: валидная ссылка 
trailerLink: валидная ссылка
thumbnail: валидная ссылка
movieId: число
nameRU: строка

DELETE http://api.badass.nomoredomains.club/movies/_id Необходимые параметры:
токен

Для удаления фильма необходимо передать его _id в самой ссылке. Удалять можно только свои фильмы. Удалять фильмы, которые добавили другие пользователи - нельзя.  
## Установка
Клонировать этот репозиторий, перейти в папку проекта и выполнить `npm ci`. После в корневой папке проекта необходимо создать файл `.env` с таким содержимым:


    NODE_ENV=production
    JWT_SECRET=<указать секретный ключ>
    MONGO_BASE=mongodb://localhost:27017/bitfilmsdb
    PORT=3000

Запуск бэкенда:

* `node app.js` или `npm run start`- запуск приложения
* `npm run dev` - автозапуск с отладкой
* `pm2 start app.js` - выполнять только из корневой директории проекта, при установленном пакете pm2  

Для запуска бэкенда необходимы настроенный сервер nginx и SSl-сертификат для выбранного домена. Домен дожен быть прописан в файле `middlewares/cors.js`, в переменной `options`.

##  Ссылка для тестирования: 
http://api.badass.nomoredomains.club/
